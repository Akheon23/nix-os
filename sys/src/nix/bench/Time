#!/bin/rc
rfork e
cmd=$1
echo '#' $1
echo measuring $1... >'#c/cons'
rm -f /tmp/bench.time
for(i in `{seq 10}){
	time rc -c $cmd >/dev/null >>[2]/tmp/bench.time
	tail -1 /tmp/bench.time
	tail -1 /tmp/bench.time >'#c/cons'
}
sed 's/[sur]//g' </tmp/bench.time |
	awk 'BEGIN{u=0.0; s=0.0; t=0.0}
	{u += $1; s += $2; t += $3}
	END{printf("times %g %g %g\n", u/NR, s/NR, t/NR);}'
rm -f /tmp/bench.time
exit ''
